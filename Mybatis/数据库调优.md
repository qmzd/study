## 数据库调优的方式

数据库调优一般有三种方式：1.数据库服务器的内和优化，2.my.cnf配置，搭配压力测试进行调试，3.sql语句调优；

#### 3.Sql语句调优：
1.使用缓存优化查询（进行多次相同的查询时，结果可放入缓存中，后续在进行相同的查询，就直接从缓存中提取，不会到表中提取），但使用缓存优化时，
  可能出现**缓存失效**，**缓存雪崩**，**缓存穿透**；
  
  **缓存失效的场景**：
  
  1.SQL语句不一致的情况，要想命中查询缓存，查询SQL语句必须一致；
  
  例：select count(*) from tb_item;
      select count(*) from tb_item;
      
  2.查询语句中有一些不确定的时，则不会缓存；例如：new(),current_date(),curdate(),rand(),uuid()...
  
  例：select * from tb_item where updatetime < now() limit 1;
      select user();
      select database();
      
  3.不使用任何表查询语句。
  
  例：select 'A';
  
  4.查询mysql，information_schema或performance_schema 数据库中的表时，不会走查询缓存；
  
  **解决方案**： sql编写时，注意避免以上场景。
  
  **缓存雪崩和解决方案**：
  
   **缓存雪崩**：一般是指由大量的Key集中在一段时间内失效，或者redis服务故障引起的，导致查询请求查不到缓存，大量的请求涌入到mysql，
                 他会导致mysql瞬间被大量的流量打死，或者由于该服务接口访问时间长，导致耗尽了线程资源，不仅会导致该服务其他接口得不
                 到线程资源，也有可能会使上游服务的资源也都耗在这，然后引起整个系统的崩溃。
                 
  
